<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>The Total Differential Value of a big phytosociological data set — bigdata_tdv • The 'diffval' package for R</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The Total Differential Value of a big phytosociological data set — bigdata_tdv"><meta name="description" content="Given a big phytosociological data set represented as a list, and a partition
of the relevés in that list, this function calculates the respective Total
Differential Value (TDV)."><meta property="og:description" content="Given a big phytosociological data set represented as a list, and a partition
of the relevés in that list, this function calculates the respective Total
Differential Value (TDV)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">The 'diffval' package for R</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://gitlab.com" aria-label="GitLab"><span class="fa fa-gitlab"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.r-project.org" aria-label="R-Project"><span class="fa fab fa-r-project"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://point-veg.gitlab.io/diffval/" aria-label="POINT-VEG packages"><span class="fa fa-home"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>The Total Differential Value of a big phytosociological data set</h1>
      <small class="dont-index">Source: <a href="https://gitlab.com/point-veg/diffval/-/blob/master/R/bigdata_tdv.R" class="external-link"><code>R/bigdata_tdv.R</code></a></small>
      <div class="d-none name"><code>bigdata_tdv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a big phytosociological data set represented as a list, and a partition
of the relevés in that list, this function calculates the respective Total
Differential Value (TDV).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bigdata_tdv</span><span class="op">(</span></span>
<span>  <span class="va">phyto_list</span>,</span>
<span>  <span class="va">p</span>,</span>
<span>  <span class="va">n_rel</span>,</span>
<span>  output_type <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mc_cores <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"mc.cores"</span>, <span class="fl">2L</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-phyto-list">phyto_list<a class="anchor" aria-label="anchor" href="#arg-phyto-list"></a></dt>
<dd><p>A list. This is a very light representation of what could
be a usual phytosociological table, registering only taxa presences. Each
component should uniquely represent a taxon and should contain a vector (of
numeric values) with the relevé(s) id(s) where that taxon was observed.
Relevé's ids are expected to be represented by consecutive integers,
starting with 1. The components of the list might be named (e.g. using the
taxon name) or empty (decreasing further memory burden). However, for
<code>output_type == "normal"</code> taxa names are useful for output interpretation.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>A vector of integer numbers with the partition of the relevés (i.e.,
a k-partition, consisting in a vector with values from 1 to k, with length
equal to the number of relevés in <code>phyto_list</code>, ascribing each relevé to
one of the k groups).</p></dd>


<dt id="arg-n-rel">n_rel<a class="anchor" aria-label="anchor" href="#arg-n-rel"></a></dt>
<dd><p>The number of relevés in <code>phyto_list</code>, obtained, for
example, using the instruction <code>length(unique(unlist(phyto_list)))</code>.</p></dd>


<dt id="arg-output-type">output_type<a class="anchor" aria-label="anchor" href="#arg-output-type"></a></dt>
<dd><p>A character determining the amount of information returned
by the function and also the amount of pre-validations. Possible values are
"normal" (the default) and "fast".</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Logical. Should function <code><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">parallel::mclapply()</a></code>) be used to
improve computation time by forking? Not available on Windows. Refer to
that function manual for more information. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-mc-cores">mc_cores<a class="anchor" aria-label="anchor" href="#arg-mc-cores"></a></dt>
<dd><p>The number of cores to be passed to <code><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">parallel::mclapply()</a></code> if
<code>parallel = TRUE</code>. See <code><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">parallel::mclapply()</a></code> for more information.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>output_type = "normal"</code> (the default) pre-validations are done
(which can take some time) and a list is returned, with the following
components (see <code><a href="tdv.html">tdv()</a></code> for the mathematical notation):</p>
<dl><dt>ifp</dt>
<dd><p>A matrix with the \(\frac{a}{b}\) values for each taxon
in each group, for short called the 'inner frequency of presences'.</p></dd>

<dt>ofda</dt>
<dd><p>A matrix with the \(\frac{c}{d}\) values for each
taxon in each group, for short called the 'outer frequency of
differentiating absences'.</p></dd>

<dt>e</dt>
<dd><p>A vector with the \(e\) values for each taxon, i.e., the
number of groups containing that taxon.</p></dd>

<dt>diffval</dt>
<dd><p>A matrix with the \(DiffVal\) for each taxon.</p></dd>

<dt>tdv</dt>
<dd><p>A numeric with the TDV of matrix <code>m_bin,</code> given the partition
<code>p</code>.</p></dd>


</dl><p>If <code>output_type = "fast"</code>, only TDV is returned and no pre-validations are
done.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function accepts a list (<code>phyto_list</code>) representing a
phytosociological data set, as well as a k-partition of its relevés (<code>p</code>),
returning the corresponding TDV (see <code><a href="tdv.html">tdv()</a></code> for an explanation
on TDV).
Partition <code>p</code> gives the group to which each relevé is ascribed, by
increasing order of relevé id.
Big phytosociological tables can occupy a significant amount of computer
memory, which mostly relate to the fact that the absences (usually more
frequent than presences) are also recorded in memory. The use of a list,
focusing only on presences, reduces significantly the amount of needed
memory to store all the information that a phytosociological table contains
and also the computation time of TDV, allowing computations for big data
sets.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Tiago Monteiro-Henriques. E-mail: <a href="mailto:tmh.dev@icloud.com">tmh.dev@icloud.com</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Getting the Taxus baccata forests data set</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">taxus_bin</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Creating a group partition, as the one presented in the original article of</span></span></span>
<span class="r-in"><span><span class="co"># the data set</span></span></span>
<span class="r-in"><span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">11</span>, <span class="fl">19</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Removing taxa occurring in only one relevé, in order to reproduce exactly</span></span></span>
<span class="r-in"><span><span class="co"># the example in the original article of the data set</span></span></span>
<span class="r-in"><span><span class="va">taxus_bin_wmt</span> <span class="op">&lt;-</span> <span class="va">taxus_bin</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">taxus_bin</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculating TDV using tdv()</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tdv.html">tdv</a></span><span class="op">(</span><span class="va">taxus_bin_wmt</span>, <span class="va">groups</span><span class="op">)</span><span class="op">$</span><span class="va">tdv</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1958471</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Converting from the phytosociologic matrix format to the list format</span></span></span>
<span class="r-in"><span><span class="va">taxus_phyto_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">taxus_bin_wmt</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Getting the number of relevés in the list</span></span></span>
<span class="r-in"><span><span class="va">n_rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">taxus_phyto_list</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculating TDV using bigdata_tdv(), even if this is not a big matrix</span></span></span>
<span class="r-in"><span><span class="fu">bigdata_tdv</span><span class="op">(</span></span></span>
<span class="r-in"><span>  phyto_list <span class="op">=</span> <span class="va">taxus_phyto_list</span>,</span></span>
<span class="r-in"><span>  p <span class="op">=</span> <span class="va">groups</span>,</span></span>
<span class="r-in"><span>  n_rel <span class="op">=</span> <span class="va">n_rel</span>,</span></span>
<span class="r-in"><span>  output_type <span class="op">=</span> <span class="st">"normal"</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">$</span><span class="va">tdv</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1958471</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tiago Monteiro-Henriques, Jorge Orestes Cerdeira, Fundação para a Ciência e a Tecnologia, Portugal.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

